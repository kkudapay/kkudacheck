<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>사업자번호 검색</title>
</head>
<body style="text-align: center; margin-top: 100px; font-family: Arial, sans-serif;">
  <h1>사업자번호 검색</h1>
  <input type="text" id="bizInput" placeholder="사업자번호 입력" style="padding: 8px; width: 200px;" />
  <button onclick="searchBiz()" style="padding: 8px 16px; margin-left: 8px;">검색</button>

  <div id="result" style="margin-top: 40px;"></div>

  <script>
    async function searchBiz() {
      const bizNumber = document.getElementById('bizInput').value.trim();
      if (!bizNumber) {
        alert('사업자번호를 입력해주세요');
        return;
      }

      const response = await fetch(`https://script.google.com/macros/s/AKfycbyoS7x3jn2WcakyfXLKbgg5cQKSbEizEP7fODGOEoLMBeENn2elJBuVKUMndKzMkGLZ/exec?bizNumber=${bizNumber}`);
      const data = await response.json();

      const resultDiv = document.getElementById('result');

      if (data.error) {
        resultDiv.innerHTML = `
          <table border="1" style="margin: 0 auto; border-collapse: collapse;">
            <thead>
              <tr style="background-color: #f0f0f0;">
                <th>사업자번호</th>
                <th>상호</th>
                <th>조회결과</th>
                <th>비고</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>${bizNumber}</td>
                <td>-</td>
                <td style="color:red;">실패</td>
                <td>${data.error}</td>
              </tr>
            </tbody>
          </table>
        `;
      } else {
        resultDiv.innerHTML = `
          <table border="1" style="margin: 0 auto; border-collapse: collapse;">
            <thead>
              <tr style="background-color: #f0f0f0;">
                <th>사업자번호</th>
                <th>상호</th>
                <th>조회결과</th>
                <th>비고</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>${data.사업자번호}</td>
                <td>${data.상호}</td>
                <td style="color:green;">정상</td>
                <td>-</td>
              </tr>
            </tbody>
          </table>
        `;
      }
    }
  </script>
</body>
</html>
